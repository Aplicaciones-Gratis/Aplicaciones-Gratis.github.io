<meta name="viewport" content="width=device-width, initial-scale=1.0" &amp;gt; />
<div id="ante"></div>
<section class="home-section">
    <div id="overlay"></div>
    <div id="dropArea">
        Arrastra y suelta un archivo aquí
    </div>
    <div id="div14">
        <br />
        <div id="chatUL">
            Cargando...
        </div>
        <a id="button4bajo" onclick="bajar()" style="animation: fadeIn 0.35s ease-out;">
            <div style="align-items: center; background: #32373a; border-radius: 50%; cursor: pointer; display: flex; height: 42px; justify-content: center; margin-bottom: 3px; margin-top: 3px; opacity: 0.9; width: 42px;"><svg height="20" viewbox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3.8 6.7l5.7 5.7 5.7-5.7 1.6 1.6-7.3 7.2-7.3-7.2 1.6-1.6z" fill="#FFFFFF"></path>
                </svg></div>
        </a>
        <form><label style="color: lightgrey;">Nombre:</label>
            <input id="conin" autocomplete="off" onchange="guardarYAutocompletar()" style="border: none; font-family: sans-serif; font-size: 15px; margin-top: 15px; max-width: 190px; outline: none; width: calc(100% - 70px);" type="text" />
            <textarea id="mensaje" name="mensaje" onkeypress="validar(event)" style="border-color: #787878; font-family: sans-serif; font-size: 15px; height: 39px; margin-top: 10px; outline: none;"></textarea>
            <button id="btnEnviar" onclick="clicado()" style="margin-top: 8px;" type="button"><svg fill="#FEFEFE" height="25px" style="cursor: pointer; margin-left: 5px;" viewbox="0 0 535.5 535.5" width="25px" xmlns="http://www.w3.org/2000/svg">
                    <polygon points="0,497.25 535.5,267.75 0,38.25 0,216.75 382.5,267.75 0,318.75">
                    </polygon>
                </svg></button><br /><input id="archivoo" style="max-width: 300px;width: 80%;cursor: pointer;color: white;" type="file" />
            <a id="porcen" style="display:none;color: white;margin-right: 3;font-family: sans-serif;font-size: 16px;">1234</a><progress id="progreso" max="100" style="display: none;" value="0">0</progress>
        </form>
    </div>
</section>
<script src="https://www.gstatic.com/firebasejs/8.9.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.9.0/firebase-analytics.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.9.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.9.0/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.9.0/firebase-storage.js"></script>
<script>
navegar = navigator.userAgent;
moes = ["Mobile", "iPhone", "iPod", "BlackBerry", "Opera Mini", "Sony", "MOT", "Nokia", "samsung"];
detctor = 0;
for (i in moes) {
    comprueo = navegar.indexOf(moes[i]);
    if (comprueo > -1) {
        detctor = 1;
    }
}
var subiendoo = false;
var inicio = "si";
var scrollTopBeforeResize = 0;
var chatonooo = 'chat';
var firebaseConfig = {
    apiKey: "AIzaSyCD7U9Nv6_l4jx-Ib4JW8Wn4STwvPK-wG4",
    authDomain: "aplicaciones-gratis-chat.firebaseapp.com",
    projectId: "aplicaciones-gratis-chat",
    storageBucket: "aplicaciones-gratis-chat.appspot.com",
    messagingSenderId: "1064882614707",
    appId: "1:1064882614707:web:20f8e52f713c9300895bc6",
    measurementId: "G-PPL3K4ESWS"
};
firebase.initializeApp(firebaseConfig);
firebase.analytics();
var txtMensaje = document.getElementById('mensaje');
var chatUL = document.getElementById('chatUL');


var url5698 = new URL(window.location.href);
var params5698 = new URLSearchParams(url5698.search);
var valorQ5698 = params5698.get('s');
if (valorQ5698 !== null) {
    chatonooo = valorQ5698;
}

function clicado() {
    if (document.getElementById('archivoo').value === "" || subiendoo === true) {
        var mensaje = txtMensaje.value;
        if (Object.entries(mensaje.trim()).length === 0) {} else {
            var nombre = document.getElementById("conin").value.trim();
            if (nombre.length === 0) { nombre = "anónimo" };
            var dia = new Date();
            var mes = (dia.getMonth() + 1)
            var fecha = (" " + dia.getHours() + ":" + dia.getMinutes() + "  " + dia.getDate() + "/" + mes + "/" + dia.getFullYear());
            var posicionContra = nombre.indexOf("contra=");
            var posicionContrab2 = nombre.indexOf("contrab=");
            if (posicionContrab2 !== -1) {
                var antesContrab2 = nombre.substring(0, posicionContrab2);
                var despuesContrab2 = nombre.substring(posicionContrab2 + "contrab=".length);
                if (antesContrab2 === "" || antesContrab2.trim() === "") {
                    nombre = "anonimo";
                } else {
                    nombre = antesContrab2;
                }
                var newChildRefb2 = firebase.database().ref('seguro').child(despuesContrab2).push({ contraelim: despuesContrab2 });
                var newChildKeyb2 = newChildRefb2.key;
                firebase.database().ref().child(chatonooo).push({ name: nombre, message: mensaje, fecha: fecha, urll: "none", ocultoono: "none", contraelim: newChildKeyb2 });
            } else {
                if (posicionContra !== -1) {
                    var antesContra = nombre.substring(0, posicionContra);
                    var despuesContra = nombre.substring(posicionContra + "contra=".length);
                    if (antesContra === "" || antesContra.trim() === "") {
                        nombre = "anonimo";
                    } else {
                        nombre = antesContra;
                    }
                    var newChildRef = firebase.database().ref('seguro').child(despuesContra).push({ message: mensaje });
                    var newChildKey = newChildRef.key;
                    firebase.database().ref().child(chatonooo).push({ name: nombre, fecha: fecha, urll: "none", ocultoono: "none", keyparacon: newChildKey, keycont: true });
                } else {
                    firebase.database().ref().child(chatonooo).push({ name: nombre, message: mensaje, fecha: fecha, ocultoono: "none", urll: "none" });
                }
            }
            txtMensaje.value = "";
            var objDiv = document.getElementById("chatUL");
            objDiv.scrollTop = objDiv.scrollHeight;
            scrollTopBeforeResize = 0;
            if (detctor == 1) {} else { document.getElementById("mensaje").focus(); }
        }
    } else {
        subiendoo = true;
        const file = document.getElementById('archivoo').files[0];
        if (file) {
            var nombre = document.getElementById("conin").value.trim();
            var fileName = file.name;
            var uniqueId
            var contraelim
            var pusoclaveono = "no"
            var posicionContra = nombre.indexOf("contra=");
            var posicionContrab2 = nombre.indexOf("contrab=");
            if (posicionContrab2 !== -1) {
                var antesContrab2 = nombre.substring(0, posicionContrab2);
                var despuesContrab2 = nombre.substring(posicionContrab2 + "contrab=".length);
                if (despuesContrab2 === "" || despuesContrab2.trim() === "") {
                    uniqueId = firebase.database().ref().push().key;
                } else {
                    if (antesContrab2 === "" || antesContrab2.trim() === "") {
                        nombre = "anonimo";
                    } else {
                        nombre = antesContrab2;
                    }
                    uniqueId = firebase.database().ref().push().key;
                    pusoclaveono = "pusocontrab"
                    var newChildRefb2 = firebase.database().ref('seguro').child(despuesContrab2).push({ contraelim: despuesContrab2 });
                    contraelim = newChildRefb2.key;
                }
            } else {
                if (posicionContra !== -1) {
                    var antesContra = nombre.substring(0, posicionContra);
                    var despuesContra = nombre.substring(posicionContra + "contra=".length);
                    if (despuesContra === "" || despuesContra.trim() === "") {
                        uniqueId = firebase.database().ref().push().key;
                    } else {
                        if (antesContra === "" || antesContra.trim() === "") {
                            nombre = "anonimo";
                        } else {
                            nombre = antesContra;
                        }
                        var keyeyeyey = firebase.database().ref().push().key;
                        uniqueId = despuesContra + "/" + keyeyeyey;
                        pusoclaveono = "pusocontra"
                        contraelim = keyeyeyey;
                    }
                } else {
                    uniqueId = firebase.database().ref().push().key;
                };
            }
            const storageRef = firebase.storage().ref(uniqueId + "/" + fileName + ".23");
            const task = storageRef.put(file);
            document.getElementById("progreso").style.cssText += "display:inline;";
            document.getElementById("porcen").style.cssText += "display:inline;";
            document.getElementById("archivoo").style.cssText += "display:none;";
            document.getElementById("btnEnviar").style.cssTex += "display:none;margin-top: 8px;";
            task.on("state_changed", function(snapshot) {
                    var percentage = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                    document.getElementById("progreso").value = percentage;
                    document.getElementById("porcen").innerHTML = percentage.toFixed(2) + "%";
                },
                (error) => {
                    subiendoo = false;
                    document.getElementById("archivoo").style.cssText += "display:initial;";
                    document.getElementById("progreso").style.cssText += "display:none;";
                    document.getElementById("porcen").style.cssText += "display:none;";
                    alert("No se pudo enviar el archivo");
                },
                () => {
                    subiendoo = false;
                    document.getElementById("progreso").style.cssText += "display:none;";
                    document.getElementById("porcen").style.cssText += "display:none;";
                    document.getElementById("archivoo").style.cssText += "display:initial;";
                    document.getElementById("btnEnviar").style.cssText += "display:inline;margin-top: 8px;";
                    if (nombre.length === 0) { nombre = "anónimo" };
                    var dia = new Date();
                    var mes = (dia.getMonth() + 1)
                    var fecha = (" " + dia.getHours() + ":" + dia.getMinutes() + "  " + dia.getDate() + "/" + mes + "/" + dia.getFullYear());
                    storageRef.getMetadata()
                        .then((metadata) => {
                            if (pusoclaveono == "pusocontra") {
                                firebase.database().ref().child(chatonooo).push({ name: nombre, message: fileName, fecha: fecha, ocultoono: "inline", urll: metadata.timeCreated, keyparacon: contraelim, keycont: true, });
                            } else {
                                if (pusoclaveono == "pusocontrab") {
                                    firebase.database().ref().child(chatonooo).push({ name: nombre, message: fileName, fecha: fecha, ocultoono: "inline", urll: metadata.timeCreated, contraelim: contraelim, carpetaaa: uniqueId, });
                                } else {
                                    firebase.database().ref().child(chatonooo).push({ name: nombre, message: fileName, fecha: fecha, ocultoono: "inline", urll: metadata.timeCreated, carpetaaa: uniqueId, });
                                }
                            }
                            document.getElementById('archivoo').value = ""
                            subiendoo = false;
                            document.getElementById("porcen").innerHTML = 0;
                            document.getElementById("progreso").value = 0;
                            var objDiv = document.getElementById("chatUL");
                            objDiv.scrollTop = objDiv.scrollHeight;
                            scrollTopBeforeResize = 0;
                            if (detctor == 1) {} else { document.getElementById("mensaje").focus(); }
                        })
                        .catch(function(error) {
                            subiendoo = false;
                            document.getElementById("archivoo").style.cssText += "display:initial;";
                            document.getElementById("progreso").style.cssText += "display:none;";
                            document.getElementById("porcen").style.cssText += "display:none;";
                            alert("No se pudo enviar el archivo");
                        })
                })
            subiendoo = false;
        } else {
            console.log('No se ha seleccionado ningún archivo.');
        }
    }
};
firebase.database().ref().child(chatonooo)
    .on('value', function(snapshot) {
        var sionomover = "no";
        var objDiv = document.getElementById("chatUL");
        if (((chatttatul.scrollHeight - chatttatul.clientHeight + 1) - chatttatul.scrollTop) < 50) { sionomover = "si"; }
        var mover2 = 0;
        var html = '';
        var chatUL = document.getElementById('chatUL');
        var elementosDiv123 = chatUL.querySelectorAll('div');
        if (elementosDiv123.length > 0) {
            elementosDiv123.forEach(function(elementoss) {
                elementoss.dataset.mencionado = false;
            });
        }
        snapshot.forEach(function(e) {
            var keey = e.key.toString();
            var elemento = document.getElementById(keey + "div");
            if (elemento) {
                elemento.dataset.mencionado = true;
            } else {

                var element = e.val();
                var nombre = element.name;
                var urll = element.urll;
                var mensaje = element.message;
                var keycont = element.keycont;
                var keyparacon = element.keyparacon;
                var ocultoono = element.ocultoono;
                var link = "";
                var claveonoarchivo = "false";
                var carpetaaa = "";
                var contraelim = element.contraelim;
                var fecha = element.fecha;
                var archielim = "";
                if (keycont == true) {
                    if (element.ocultoono == "none") {
                        mensaje = '<input id="' + keyparacon + '" autocomplete="off" onkeypress="verifiseguro(this.id,event,this.getAttribute(\'nombr\'))" nombr="' + keey + '" style="border-radius: 5px;border-color: #000000;font-family: sans-serif;font-size: 15px;margin-top: 8px;max-width: 190px;background-color: #212121;outline: none;width: calc(100% - 70px);height: 25px;" placeholder="Escribe la contraseña" type="text">'
                    } else {
                        mensaje = '<input id="' + keyparacon + '" autocomplete="off" onkeypress="verifiarchiseguro(this.id,event,this.getAttribute(\'nombr\'), this.getAttribute(\'mensaje\'), this.getAttribute(\'urll\'),)" urll="' + urll + '"  mensaje="' + mensaje + '" nombr="' + keey + '" style="border-radius: 5px;border-color: #000000;font-family: sans-serif;font-size: 15px;margin-top: 8px;max-width: 190px;background-color: #212121;outline: none;width: calc(100% - 70px);height: 25px;" placeholder="Escribe la contraseña" type="text">'
                        claveonoarchivo = "true";
                        archielim = carpetaaa + "/" + element.message + ".23";
                        ocultoono = "none";
                    }
                } else {
                    if (contraelim == undefined || contraelim.length == 0 || contraelim == "undefined") {
                        contraelim = "";
                    } else {
                        claveonoarchivo = "solocon";
                    }
                    if (element.ocultoono == "none") {
                        mensaje = mensaje.replaceAll("<", "&lt;");
                        mensaje = mensaje.replaceAll(">", "&gt;");
                        mensaje = mensaje.replace(/http([^"' <>\b\n]+)/g, "<a target='_blank' href='http$1'>http$1</a>");
                    } else {
                        link = mensaje;
                        carpetaaa = element.carpetaaa;
                        archielim = carpetaaa + "/" + mensaje + ".23";
                    }
                }
                html += "<div id=" + keey + "div" + " style='margin-bottom: 6px;margin-top: 6px;margin-left: 5px;margin-right: 8px;border-color: #282b2d;background-color: #282b2d;border-radius: 10px;'><textarea class='uno' readonly='readonly'>" + nombre + "</textarea><svg id='" + keey + "' onclick='hecv(this.id, \"" + archielim + "\",\"" + keyparacon + "\",this.getAttribute(\"contra\"),this.getAttribute(\"claveonoarchivo\"),)' claveonoarchivo='" + claveonoarchivo + "' style='margin-top: 5px;margin-right: 2px;float:right;' contra='" + contraelim + "' fill=#ffffff width='20' height='20' viewBox='0 0 26 26'><path d='M18.4 4L12 10.4L5.6 4L4 5.6L10.4 12L4 18.4L5.6 20L12 13.6L18.4 20L20 18.4L13.6 12L20 5.6L18.4 4Z'></path></svg><br><pre ondblclick='copiiii(this, event)' id='" + keyparacon + "segundo' style='border-color: #282b2d;background-color: #282b2d;top:auto;resize: none;color:#FFFFFF;outline: none;margin-left: 8px;' readonly='readonly' class='dos'>" + mensaje + "</pre><a style='cursor:pointer;background: #252525;padding: 2px;border-radius: 5px;margin-left:7px;color: #4b74b7;font-size:13px;display:" + ocultoono + ";' onclick='descargararchi(this.title, this.type, this, \"" + carpetaaa + "\")' title='" + link + "' type='" + urll + "' target='_blank'>Descargar</a><br><a class='tres'>" + fecha + "</a></div>";
                mover2 += 1;

            }
        });

        var elementosDiv = chatUL.querySelectorAll('div');
        if (elementosDiv.length > 0) {
            elementosDiv.forEach(function(elementoss) {
                if (elementoss.dataset.mencionado !== 'true') {
                    elementoss.remove();
                }
            });
        }
        if (inicio === "si") {
            chatUL.innerHTML = html;
            setTimeout(() => {
                chatUL.style.scrollBehavior = "smooth";
            }, 500);
        } else {
            chatUL.innerHTML += html;
        }
        if (mover2 > 0) {
            if (inicio === "si") {
                inicio = "no";
                var objDiv = document.getElementById("chatUL");
                objDiv.scrollTop = objDiv.scrollHeight;
                scrollTopBeforeResize = 0;
            } else {
                if (sionomover === "si") {
                    var objDiv = document.getElementById("chatUL");
                    objDiv.scrollTop = objDiv.scrollHeight;
                    scrollTopBeforeResize = 0;
                }
            }
        }
    });

function validar(e) {
    tecla = (document.all) ? e.keyCode : e.which;
    if (tecla == 13) {
        if (e.shiftKey == 1) {} else {
            var txtMensaje = document.getElementById('mensaje');
            var mensaje = txtMensaje.value.trim();
            if (Object.entries(mensaje).length === 0) {} else {
                if (detctor == 1) {} else {
                    document.getElementById("btnEnviar").click();
                }
            }
            e.preventDefault();
            return false;
        }
    }
}

window.addEventListener('resize', function() {
    document.getElementById('chatUL').scrollTop = (chatttatul.scrollHeight - chatttatul.clientHeight + 1) - scrollTopBeforeResize;
});


function hecv(cha, archieli, keyparacon, contra, claveonoarchivo) {
    if (claveonoarchivo == "true") {
        var storageRef = firebase.storage().ref(contra + "/" + keyparacon + "/" + archieli);
        storageRef.delete().then(function() {
            firebase.database().ref().child(chatonooo + '/' + cha).remove();
        }).catch(function(error) {
            console.error(error);
        });
    } else {
        if (claveonoarchivo !== "solocon") {
            if (archieli != "") {
                var storageRef = firebase.storage().ref(archieli);
                storageRef.delete().then(function() {}).catch(function(error) {
                    console.error(error);
                });
            }
        }
        if (keyparacon != "undefined") {
            var ref = firebase.database().ref().child('seguro/' + contra + '/' + keyparacon.toString());
            ref.once('value').then(function(snapshot) {
                if (snapshot.exists()) {
                    ref.remove();
                    firebase.database().ref().child(chatonooo + '/' + cha).remove();
                }
            });

        } else {
            if (contra == undefined || contra.length == 0 || contra == "undefined") {
                firebase.database().ref().child(chatonooo + '/' + cha).remove();
            } else {
                var contraseña = prompt("Por favor, ingresa la contraseña:");
                var refb2 = firebase.database().ref().child('seguro/' + contraseña + '/' + contra.toString());
                refb2.once('value').then(function(snapshot) {
                    if (snapshot.exists()) {
                        if (archieli != "") {
                            var storageRef = firebase.storage().ref(archieli);
                            storageRef.delete().then(function() {}).catch(function(error) {
                                console.error(error);
                            });
                        }
                        refb2.remove();
                        firebase.database().ref().child(chatonooo + '/' + cha).remove();
                    }
                });
            }
        }
    }

}


function guardarYAutocompletar() {
    var contenido = document.getElementById('conin').value;
    localStorage.setItem('Nombreee', contenido);
}


function bajar() {
    var objDiv = document.getElementById("chatUL");
    objDiv.scrollTop = objDiv.scrollHeight;
    scrollTopBeforeResize = 0;
}


function copiiii(elemento, event) {
    if (event.ctrlKey) {
        var texto = elemento.textContent || elemento.innerText;
        var tempTextArea = document.createElement("textarea");
        tempTextArea.value = texto;
        document.body.appendChild(tempTextArea);
        tempTextArea.select();
        document.execCommand("copy");
        document.body.removeChild(tempTextArea);
    }
}

function verifiseguro(uidss, e, cambiar) {
    tecla = (document.all) ? e.keyCode : e.which;
    if (tecla == 13) {
        firebase.database().ref('seguro/' + document.getElementById(uidss).value + '/' + uidss.toString()).once('value')
            .then((snapshot) => {
                var securedData = snapshot.val();
                if (securedData) {
                    document.getElementById(cambiar).setAttribute('contra', document.getElementById(uidss).value);
                    var mensaje = securedData.message;
                    mensaje = mensaje.replaceAll("<", "&lt;");
                    mensaje = mensaje.replaceAll(">", "&gt;");
                    mensaje = mensaje.replace(/http([^"' <>\b\n]+)/g, "<a target='_blank' href='http$1'>http$1</a>");
                    document.getElementById(uidss + "segundo").innerHTML = mensaje;
                }
            });
    }
}

function verifiarchiseguro(uidss, e, cambiar, mensajenom, urll) {
    tecla = (document.all) ? e.keyCode : e.which;
    if (tecla == 13) {
        async function checkFileExistence(fileName1) {
            const storage123Ref = firebase.storage().ref(fileName1);

            try {
                const url = await storage123Ref.getDownloadURL();
                if (url) {
                    document.getElementById(cambiar).setAttribute('contra', document.getElementById(uidss).value);
                    document.getElementById(uidss + "segundo").style.height = "40px";
                    document.getElementById(uidss + "segundo").style.marginBottom = "-5px";
                    document.getElementById(uidss + "segundo").innerHTML = mensajenom + '<br><a style="cursor:pointer;background: #252525;padding: 2px;border-radius: 5px;width: 65px;color: #4b74b7;font-size:13px;margin-top: 2px;display:flex;" onclick="descargararchi(this.title, this.type, this, &quot;' + document.getElementById(uidss).value + '/' + uidss.toString() + '&quot;)" title="' + mensajenom + '" type="' + urll + '" target="_blank">Descargar</a>';

                } else {
                    fileExists = false;
                    return fileName1;
                }
            } catch (error) {
                return fileName1;
            }
        }
        checkFileExistence(document.getElementById(uidss).value + '/' + uidss.toString() + "/" + mensajenom + ".23")
    }
}


function descargararchi(nombre, urll, descargaaa, carpetaaa) {
    if (descargaaa.innerHTML == "Descargar") {
        var storageRef = firebase.storage().ref(carpetaaa + "/" + nombre + ".23");
        storageRef.getMetadata()
            .then((metadata) => {
                storageRef.getDownloadURL()
                    .then((url) => {
                        if (urll) {
                            if (metadata.timeCreated.toString() == urll.toString()) {
                                const xhr = new XMLHttpRequest();
                                xhr.responseType = 'blob';
                                xhr.onprogress = (event) => {
                                    if (event.lengthComputable) {
                                        const percentComplete = (event.loaded / event.total) * 100;
                                        descargaaa.innerHTML = (`${percentComplete.toFixed(2)}%` + "  <progress value=" + percentComplete.toFixed(2) + " max='100'></progress>")
                                    }
                                };
                                xhr.onload = (event) => {
                                    const blob = xhr.response;
                                    const blobURL = URL.createObjectURL(blob);
                                    const downloadLink = document.createElement('a');
                                    downloadLink.href = blobURL;
                                    downloadLink.download = nombre;
                                    document.body.appendChild(downloadLink);
                                    downloadLink.click();
                                    document.body.removeChild(downloadLink);
                                    URL.revokeObjectURL(blobURL);
                                    descargaaa.innerHTML = "Descargar"
                                };
                                xhr.open('GET', url);
                                xhr.send();
                            } else {
                                if (confirm("El archivo a sido modificado desde que se subio, ¿desea descargarlo de todos modos?")) {
                                    const xhr = new XMLHttpRequest();
                                    xhr.responseType = 'blob';
                                    xhr.onprogress = (event) => {
                                        if (event.lengthComputable) {
                                            const percentComplete = (event.loaded / event.total) * 100;
                                            descargaaa.innerHTML = (`${percentComplete.toFixed(2)}%` + "  <progress value=" + percentComplete.toFixed(2) + " max='100'></progress>")
                                        }
                                    };
                                    xhr.onload = (event) => {
                                        const blob = xhr.response;
                                        const blobURL = URL.createObjectURL(blob);
                                        const downloadLink = document.createElement('a');
                                        downloadLink.href = blobURL;
                                        downloadLink.download = nombre;
                                        document.body.appendChild(downloadLink);
                                        downloadLink.click();
                                        document.body.removeChild(downloadLink);
                                        URL.revokeObjectURL(blobURL);
                                        descargaaa.innerHTML = "Descargar"
                                    };
                                    xhr.open('GET', url);
                                    xhr.send();
                                }
                            }
                        } else {
                            const xhr = new XMLHttpRequest();
                            xhr.responseType = 'blob';
                            xhr.onprogress = (event) => {
                                if (event.lengthComputable) {
                                    const percentComplete = (event.loaded / event.total) * 100;
                                    descargaaa.innerHTML = (`${percentComplete.toFixed(2)}%` + "  <progress value=" + percentComplete.toFixed(2) + " max='100'></progress>")
                                }
                            };
                            xhr.onload = (event) => {
                                const blob = xhr.response;
                                const blobURL = URL.createObjectURL(blob);
                                const downloadLink = document.createElement('a');
                                downloadLink.href = blobURL;
                                downloadLink.download = nombre;
                                document.body.appendChild(downloadLink);
                                downloadLink.click();
                                document.body.removeChild(downloadLink);
                                URL.revokeObjectURL(blobURL);
                                descargaaa.innerHTML = "Descargar"
                            };
                            xhr.open('GET', url);
                            xhr.send();
                        }
                    })
                    .catch((error) => { descargaaa.innerHTML = "Descargar" });
            })
            .catch(function(error) {
                alert("Este archivo a sido eliminado");
            })
        descargaaa.innerHTML = "Descargar"
    }
};

document.addEventListener('DOMContentLoaded', function() {
    const dropArea = document.getElementById('dropArea');
    const areapantalla = document.getElementById('overlay');
    const archivoo = document.getElementById('archivoo');
    document.addEventListener('dragover', function(e) {
        if (e.dataTransfer.types.includes("Files")) {
            e.preventDefault();
            dropArea.style.display = 'flex';
            areapantalla.style.display = 'flex';
        }
    });
    document.addEventListener('dragleave', function(e) {
        e.preventDefault();
        if (e.relatedTarget === null) {
            dropArea.style.display = 'none';
            areapantalla.style.display = 'none';
        }
    });
    document.addEventListener('drop', function(e) {
        e.preventDefault();
        dropArea.style.display = 'none';
        areapantalla.style.display = 'none';
    });

    dropArea.addEventListener('dragenter', preventDefaults, false);
    dropArea.addEventListener('dragover', preventDefaults, false);
    dropArea.addEventListener('drop', handleDrop, false);

    function preventDefaults(e) {
        e.stopPropagation();
        e.preventDefault();
    }

    function handleDrop(e) {
        let files = e.dataTransfer.files;

        if (files.length) {
            archivoo.files = files;
        }
    }
});

const dropArea = document.getElementById('dropArea');

dropArea.addEventListener('dragenter', preventDefaults, false);
dropArea.addEventListener('dragover', dragOver, false);
dropArea.addEventListener('dragleave', dragLeave, false);
dropArea.addEventListener('drop', dropHandler, false);

function preventDefaults(e) {
    e.stopPropagation();
    e.preventDefault();
}

var chatttatul = document.getElementById('chatUL')
chatttatul.addEventListener('scroll', function() {
    if (((chatttatul.scrollHeight - chatttatul.clientHeight + 1) - chatttatul.scrollTop) < 50) {
        document.getElementById("button4bajo").style.display = "none"
    } else {
        document.getElementById("button4bajo").style.display = "flex"
    }
    scrollTopBeforeResize = ((chatttatul.scrollHeight - chatttatul.clientHeight + 1) - chatttatul.scrollTop);
});


function dragOver(e) {
    dropArea.style.background = "#1d1d1d";
}

function dragLeave(e) {
    dropArea.style.background = "#323232";
}

function dropHandler(e) {
    dropArea.style.background = "#323232";
}

function autocompletar() {
    var contenidoGuardado = localStorage.getItem('Nombreee');
    if (contenidoGuardado) {
        document.getElementById('conin').value = contenidoGuardado;
    }
}
window.onload = autocompletar;
</script>
<style>
html {
    color-scheme: dark !important;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: "Poppins", sans-serif;
}

.home-section .text {
    display: inline-block;
    color: #11101d;
    font-size: 25px;
    font-weight: 500;
    margin: 18px
}

#chatUL::-webkit-scrollbar-track {
    -webkit-box-shadow: inset 0 0 6px rgb(0 0 0 / 30%);
    background-color: #202020;
    border-radius: 10px;
}

#chatUL::-webkit-scrollbar {
    width: 10px;
    background-color: #202020;
}

#mensaje {
    max-height: 100px;
    min-height: 41px;
    width: calc(100% - 60px);
    overflow: auto;
    resize: none;
}

#chatUL::-webkit-scrollbar-thumb {
    border-radius: 10px;
    background-color: rgb(63, 68, 71);
}

*,
*:after,
*:before {
    margin: 0;
    padding: 0;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
}

#btnEnviar {
    cursor: pointer;
    margin-top: -3px;
    width: 48px;
    height: 48px;
    margin-left: 8px;
    position: absolute;
    border: none;
    background: #32373a;
    border-radius: 50%;
    justify-content: center;
    align-items: center;
}

#div14 {
    max-width: 850px;
    margin: auto;
    position: relative;
}

#{
max-width:95%;
max-height:100px;
min-height: 41px;
min-width: 95%;
overflow: auto;
resize: none;
}

#chatUL {
    border: 0.5px solid #333333;
    width: 100%;
    height: calc(100% - 170px);
    overflow: auto;
    min-height: 100px;
    min-width: 157px;
}


#button4bajo {
    color: #FEFEFE;
    text-decoration: none;
    float: right;
    z-index: 2;
    display: none;
    bottom: 49;
    position: relative;
    right: 13px;
}

#chatUL .uno {
    border-radius: 10px;
    color: #ef7575;
    font-size: 17.4px;
    font-family: sans-serif;
    margin-left: 5px;
    line-height: 30px;
    max-height: 30px;
    max-width: 95%;
    resize: none;
    overflow-y: hidden;
    border: none;
    background-color: #282b2d;
    outline: none;
    width: 75%;
}

.dos::-webkit-scrollbar {
    width: 10px;
    height: 10px;
    background-color: #282b2d;
}

.dos::-webkit-scrollbar-thumb {
    border-radius: 10px;
    background-color: #575758;
}

#chatUL .dos {
    word-break: break-word;
    white-space: pre-wrap;
    width: 95%;
    overflow: auto;
    font-family: sans-serif;
    font-size: 16px;
    margin-top: 0px;
    margin-bottom: 10px;
    max-height: 250px;
}

#chatUL .tres {
    font-size: 11px;
    margin-left: -111px;
    float: right;
    position: relative;
    top: -17px;
    right: 7px;
    line-height: 10px;
    color: #bcbcbc;
}

div.widget.PopularPosts {
    display: none;
}

a {
    color: #2196f3;
}

body {
    background-color: rgb(19 23 25);
    color: white;
    background-image: none;
    text-align: left;
    position: relative;
    cursor: default;
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(5px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@media screen and (min-width:0px) and (max-width:900px) {
    #div14 {
        margin: 10px;
    }

    body {
        background-color: #1d1d1d;
    }

    .bg-photo-overlay {
        background-color: #1d1d1d;
    }

    button.svg-icon-24-button.back-button.rtl-reversible-icon.flat-icon-button.ripple {
        margin-left: -11px !important;
        margin-top: -11px !important;
    }
}
}

section.comments {
    display: none;
}

div.post-bottom {
    display: none;
}

h3.post-title.entry-title {
    display: none;
}

div.post-header-line-1 {
    display: none;
}

div.blog-name.container {
    display: none;
}

svg.svg-icon-24.search-expand-icon {
    display: none;
}

header.centered-top-container.sticky.animating {
    display: none;
}

div.post-header-line-1 {
    display: none;
}

h3.post-title.entry-title {
    display: none;
}

div.flat-icon-button.ripple {
    display: none;
}

footer.footer.section {
    display: none;
}

button.svg-icon-24-button.back-button.rtl-reversible-icon.flat-icon-button.ripple {
    margin-left: 15px;
    margin-top: 5px;
}

.gsc-control-cse {
    display: none;
}

#overlay {
    display: none;
    background-color: rgba(0, 0, 0, 0.6);
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    z-index: 9999;
}

#dropArea {
    display: none;
    align-items: center;
    justify-content: center;
    background-color: #323232;
    color: white;
    font-family: sans-serif;
    font-size: 19px;
    width: 99%;
    height: 80%;
    border: 2px dashed #d4d4d4;
    z-index: 10000;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}
</style>
